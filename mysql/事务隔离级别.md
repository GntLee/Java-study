# 事务隔离级别



### 数据库的四大特性ACID

##### 原子性（Atomicity）

> 所有操作要么全部成功，要么全部失败回滚。

##### 一致性（Consistency）

> 事务的执行不改变数据库的一致。即事务执行前如果数据库一致，事务执行后，这种一致性仍然存在。例如：账户A和账户B各有余额200元，账户A向B转账200元，最终AB总和也应该是400元。

##### 隔离性（Isolation）

> 当多个用户并发访问数据库时，数据库为每一个用户开启的事务，不能被其他事务的操作所干扰。

##### 持久性（Durability）

> 一旦事务成功完成执行，并且提交到数据库，那么这一次更新将会持久的。也就是说，只要事务成功执行，任何的系统故障都不能撤销这一次事务的提交。



> 事务：保证数据一致性，要么执行，要么不执行，mysql默认事务隔离级别：`REPEATABLE-READ`

```MYSQL
mysql> select @@tx_isolation;
+-----------------+
| @@tx_isolation  |
+-----------------+
| REPEATABLE-READ |
+-----------------+
```

* 开启事务

```mysql
start transaction;
```



### 三个问题

* `不可重复读`：指在一个事务中，对同一数据进行了两次读取，但是在这个事务还未结束的时候（第一次读取之后，第二次读取之前），另一事务读取了同一数据，并进行了修改，那就导致了两次重复读取的数据不一致，形成了不可重复读状态。
* `幻读`：幻读发生在两个事务非独立执行的情况。
* `脏读`：当一个事务在访问某一数据，并且修改了这一数据，但是在commit之前，另外一个事务也访问了同一数据，然后做了修改。



### 四大隔离级别

`可串行化（Serializable）`：最高的隔离性级别，能够避免脏读，幻读，不可重复读。代价也相对沉重，会大大影响数据库的性能。

`可重复读（Repeatable read）`：只允许读取已提交的数据，而且在一个事务两次读取一个数据项期间，其他事务不得更新该数据。这种状态**不能避免幻读**。

`已提交读（Read committed）`：只允许读取已提交数据，但不要求可重复读。这种状态只能避免**脏读**。

`未提交读（Read uncommitted）`：允许读取未提交的数据。这是最低的隔离级别，脏读，幻读，不可重复读都无法避免。